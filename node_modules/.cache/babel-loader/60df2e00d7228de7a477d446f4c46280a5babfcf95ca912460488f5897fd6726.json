{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lamtm\\\\Downloads\\\\cracklist-web\\\\src\\\\components\\\\Lobby.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { doc, updateDoc } from 'firebase/firestore';\nimport { db } from '../firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LETTERS = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\nconst THEMES_LIST = [\"Prénom masculin\", \"Prénom féminin\", \"Ville\", \"Pays\", \"Continent\", \"Animal\", \"Fruit\", \"Légume\", \"Métier\", \"Objet\", \"Couleur\", \"Sport\", \"Film\", \"Série\", \"Chanson\", \"Marque\", \"Moyen de transport\", \"Instrument de musique\", \"Langue\", \"Livre\", \"Dessin animé\", \"Invention\", \"Monument\", \"Fleuve ou rivière\", \"Oiseau\", \"Insecte\", \"Plante ou arbre\", \"Pièce de la maison\", \"Partie du corps\", \"Alimentation\", \"Boisson\", \"Marque de vêtements\", \"Émotion\", \"Super-héros\", \"Pokémon\", \"Pays qui commence par…\", \"Film de Disney\", \"Animal marin\", \"Animal de la savane\", \"Animal de compagnie\", \"Pays en Europe\", \"Pays en Afrique\", \"Ville française\", \"Ville américaine\", \"Objet électronique\", \"Pays où il fait chaud\", \"Pays avec une mer\", \"Profession médicale\", \"Marque de voiture\", \"Équipe de foot\", \"Personnage de manga\", \"Jeu vidéo\", \"Appli mobile\", \"Nom de famille courant\", \"Chiffre ou nombre\", \"Mot en anglais\", \"Mot en français\", \"Signe du zodiaque\", \"Emoji connu\", \"Appareil électroménager\", \"Nom de star internationale\", \"Nom de star française\", \"Personnage historique\", \"Nom de dinosaure\", \"Élément chimique\", \"Forme géométrique\", \"Langue morte\", \"Pays commençant par une voyelle\", \"Mot avec 3 lettres\", \"Mot avec 5 lettres\", \"Animal volant\", \"Pays limitrophe de la France\", \"Ville avec une plage\", \"Métier en rapport avec l'école\", \"Métier en rapport avec la police\", \"Métier en rapport avec les animaux\", \"Métier qu'on voit à la télé\", \"Chanson connue\", \"Groupe de musique\", \"Chiffre impair\", \"Couleur primaire\", \"Style musical\", \"Accessoire de mode\", \"Pays ayant gagné la Coupe du Monde\", \"Mot finissant par -ette\", \"Mot finissant par -oir\", \"Mot qui rime avec \\\"chat\\\"\", \"Mot qui rime avec \\\"on\\\"\"];\nfunction generateCards() {\n  const cards = [];\n\n  // 5 cartes lettres aléatoires\n  for (let i = 0; i < 5; i++) {\n    cards.push({\n      type: 'letter',\n      letter: LETTERS[Math.floor(Math.random() * LETTERS.length)],\n      id: `letter_${i}_${Date.now()}_${Math.random()}`\n    });\n  }\n\n  // 1 joker\n  cards.push({\n    type: 'joker',\n    id: `joker_${Date.now()}_${Math.random()}`\n  });\n\n  // 1 carte spéciale aléatoire\n  const specialCards = ['reverse', 'swap', 'stop'];\n  cards.push({\n    type: specialCards[Math.floor(Math.random() * specialCards.length)],\n    id: `special_${Date.now()}_${Math.random()}`\n  });\n\n  // 1 carte Crakitoko avec 3 thèmes aléatoires\n  const shuffledThemes = [...THEMES_LIST].sort(() => 0.5 - Math.random());\n  cards.push({\n    type: 'crakitoko',\n    themes: shuffledThemes.slice(0, 3),\n    id: `crakitoko_${Date.now()}_${Math.random()}`\n  });\n  return cards;\n}\nfunction generateDeck() {\n  const deck = [];\n\n  // Générer plusieurs cartes de chaque type pour la pioche\n  for (let i = 0; i < 50; i++) {\n    deck.push({\n      type: 'letter',\n      letter: LETTERS[Math.floor(Math.random() * LETTERS.length)],\n      id: `deck_letter_${i}_${Date.now()}_${Math.random()}`\n    });\n  }\n  for (let i = 0; i < 10; i++) {\n    deck.push({\n      type: 'joker',\n      id: `deck_joker_${i}_${Date.now()}_${Math.random()}`\n    });\n  }\n  for (let i = 0; i < 15; i++) {\n    const specialCards = ['reverse', 'swap', 'stop'];\n    deck.push({\n      type: specialCards[Math.floor(Math.random() * specialCards.length)],\n      id: `deck_special_${i}_${Date.now()}_${Math.random()}`\n    });\n  }\n  for (let i = 0; i < 20; i++) {\n    const shuffledThemes = [...THEMES_LIST].sort(() => 0.5 - Math.random());\n    deck.push({\n      type: 'crakitoko',\n      themes: shuffledThemes.slice(0, 3),\n      id: `deck_crakitoko_${i}_${Date.now()}_${Math.random()}`\n    });\n  }\n  return deck.sort(() => 0.5 - Math.random());\n}\nfunction Lobby({\n  roomCode,\n  playerName,\n  playerId,\n  roomData,\n  onLeaveRoom\n}) {\n  _s();\n  var _normalizedPlayers$fi;\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  // Normaliser players pour qu'il soit toujours un Array valide\n  const normalizedPlayers = React.useMemo(() => {\n    if (!(roomData !== null && roomData !== void 0 && roomData.players)) return [];\n    if (Array.isArray(roomData.players)) {\n      return roomData.players.filter(p => p && p.id && p.name);\n    }\n    if (typeof roomData.players === 'object') {\n      const playersArray = Object.values(roomData.players).filter(p => p && typeof p === 'object' && p.id && p.name);\n      return playersArray;\n    }\n    return [];\n  }, [roomData === null || roomData === void 0 ? void 0 : roomData.players]);\n  const isHost = ((_normalizedPlayers$fi = normalizedPlayers.find(p => p.id === playerId)) === null || _normalizedPlayers$fi === void 0 ? void 0 : _normalizedPlayers$fi.isHost) || false;\n  const canStart = normalizedPlayers.length >= 2;\n\n  // Mise à jour de présence SANS créer de boucle infinie\n  useEffect(() => {\n    if (roomData !== null && roomData !== void 0 && roomData.gameStarted) {\n      return;\n    }\n    const updatePresence = async () => {\n      try {\n        // NE PAS utiliser normalizedPlayers ici car il cause des problèmes\n        // Utiliser directement roomData.players\n        if (!(roomData !== null && roomData !== void 0 && roomData.players)) return;\n        let playerIndex = -1;\n        if (Array.isArray(roomData.players)) {\n          playerIndex = roomData.players.findIndex(p => p && p.id === playerId);\n        } else if (typeof roomData.players === 'object') {\n          const playersArray = Object.values(roomData.players);\n          playerIndex = playersArray.findIndex(p => p && p.id === playerId);\n        }\n        if (playerIndex !== -1) {\n          await updateDoc(doc(db, 'rooms', roomCode), {\n            [`players.${playerIndex}.lastSeen`]: Date.now(),\n            [`players.${playerIndex}.connected`]: true\n          });\n        }\n      } catch (err) {\n        console.error('Erreur mise à jour présence:', err);\n      }\n    };\n\n    // Mise à jour initiale\n    updatePresence();\n\n    // Mise à jour périodique\n    const interval = setInterval(updatePresence, 30000); // Toutes les 30 secondes\n\n    return () => clearInterval(interval);\n  }, [roomCode, playerId, roomData === null || roomData === void 0 ? void 0 : roomData.gameStarted]); // Dépendances minimales\n\n  const startGame = async () => {\n    if (!canStart) {\n      setError('Il faut au moins 2 joueurs pour commencer');\n      return;\n    }\n    setLoading(true);\n    setError('');\n    try {\n      // Choisir un joueur aléatoire pour choisir le thème initial\n      const randomPlayerIndex = Math.floor(Math.random() * normalizedPlayers.length);\n\n      // Préparer les joueurs pour le jeu\n      const gamePlayers = normalizedPlayers.map(player => ({\n        ...player,\n        cards: player.cards || generateCards()\n      }));\n\n      // Créer une carte Crakitoko avec 3 thèmes pour la sélection initiale\n      const shuffledThemes = [...THEMES_LIST].sort(() => 0.5 - Math.random());\n      const initialThemeChoices = shuffledThemes.slice(0, 3);\n\n      // Générer le deck\n      const deck = generateDeck();\n      await updateDoc(doc(db, 'rooms', roomCode), {\n        gameStarted: true,\n        currentPlayerIndex: randomPlayerIndex,\n        themeSelectionPhase: true,\n        gamePhase: 'theme-selection',\n        currentRound: 1,\n        gameStartTime: Date.now(),\n        themeChoices: initialThemeChoices,\n        players: gamePlayers,\n        direction: 1,\n        deck: deck,\n        lastPlayedCard: null,\n        votes: {},\n        currentTheme: null\n      });\n    } catch (err) {\n      setError('Erreur lors du démarrage de la partie');\n      console.error('Erreur startGame:', err);\n    }\n    setLoading(false);\n  };\n  const leaveRoom = async () => {\n    try {\n      if (roomData && normalizedPlayers.length > 0) {\n        const updatedPlayers = normalizedPlayers.filter(p => p.id !== playerId);\n        if (updatedPlayers.length > 0) {\n          // Si l'hôte part, donner les droits d'hôte au premier joueur restant\n          if (isHost) {\n            updatedPlayers[0].isHost = true;\n          }\n          await updateDoc(doc(db, 'rooms', roomCode), {\n            players: updatedPlayers\n          });\n        }\n      }\n    } catch (err) {\n      console.error('Erreur lors de la sortie de la room:', err);\n    }\n    onLeaveRoom();\n  };\n  if (!roomData) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"Chargement...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"lobby\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"lobby-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lobby-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [\"\\uD83C\\uDFAE Salle: \", roomCode]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: leaveRoom,\n          className: \"btn btn-danger leave-btn\",\n          children: \"Quitter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"players-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"\\uD83D\\uDC65 Joueurs (\", normalizedPlayers.length, \"/10)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"players-list\",\n          children: normalizedPlayers.length > 0 ? normalizedPlayers.map(player => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `player-card ${!player.connected ? 'disconnected' : ''}`,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"player-name\",\n              children: [player.name, player.isHost && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"host-badge\",\n                children: \"\\uD83D\\uDC51\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 37\n              }, this), !player.connected && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"disconnect-badge\",\n                children: \"\\uD83D\\uDCF4\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 17\n            }, this)\n          }, player.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 15\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"Chargement des joueurs...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this), isHost && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"host-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83C\\uDFAF Contr\\xF4les d'h\\xF4te\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 13\n        }, this), !canStart && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"warning\",\n          children: \"Il faut au moins 2 joueurs pour commencer la partie.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startGame,\n          disabled: !canStart || loading,\n          className: \"btn btn-primary start-btn\",\n          children: loading ? 'Démarrage...' : 'Commencer la partie'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 13\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 11\n      }, this), !isHost && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"waiting-message\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u23F3 En attente que l'h\\xF4te lance la partie...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lobby-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83D\\uDCCB R\\xE8gles du jeu\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\uD83C\\uDFAF Quand vous posez une carte, les autres votent\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\uD83D\\uDDF3\\uFE0F Ils votent si vous pouvez dire un mot selon le th\\xE8me\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u274C Vote n\\xE9gatif = vous r\\xE9cup\\xE9rez votre carte + 1 de la pioche\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u2705 Vote positif = le joueur suivant prend le malus de la lettre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\uD83C\\uDCCF Joker = aucun malus peu importe ce que vous dites\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\u23F1\\uFE0F 15 secondes pour jouer, 10 secondes pour voter\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"\\uD83C\\uDFC6 Premier sans cartes gagne !\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 251,\n    columnNumber: 5\n  }, this);\n}\n_s(Lobby, \"Ye53rK4AvgxQoJ+6/dr/HdqroR0=\");\n_c = Lobby;\nexport default Lobby;\nvar _c;\n$RefreshReg$(_c, \"Lobby\");","map":{"version":3,"names":["React","useState","useEffect","doc","updateDoc","db","jsxDEV","_jsxDEV","LETTERS","THEMES_LIST","generateCards","cards","i","push","type","letter","Math","floor","random","length","id","Date","now","specialCards","shuffledThemes","sort","themes","slice","generateDeck","deck","Lobby","roomCode","playerName","playerId","roomData","onLeaveRoom","_s","_normalizedPlayers$fi","loading","setLoading","error","setError","normalizedPlayers","useMemo","players","Array","isArray","filter","p","name","playersArray","Object","values","isHost","find","canStart","gameStarted","updatePresence","playerIndex","findIndex","err","console","interval","setInterval","clearInterval","startGame","randomPlayerIndex","gamePlayers","map","player","initialThemeChoices","currentPlayerIndex","themeSelectionPhase","gamePhase","currentRound","gameStartTime","themeChoices","direction","lastPlayedCard","votes","currentTheme","leaveRoom","updatedPlayers","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","connected","disabled","_c","$RefreshReg$"],"sources":["C:/Users/lamtm/Downloads/cracklist-web/src/components/Lobby.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { doc, updateDoc } from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\n\r\nconst LETTERS = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n\r\nconst THEMES_LIST = [\r\n  \"Prénom masculin\", \"Prénom féminin\", \"Ville\", \"Pays\", \"Continent\", \"Animal\", \r\n  \"Fruit\", \"Légume\", \"Métier\", \"Objet\", \"Couleur\", \"Sport\", \"Film\", \"Série\", \r\n  \"Chanson\", \"Marque\", \"Moyen de transport\", \"Instrument de musique\", \"Langue\", \r\n  \"Livre\", \"Dessin animé\", \"Invention\", \"Monument\", \"Fleuve ou rivière\", \"Oiseau\", \r\n  \"Insecte\", \"Plante ou arbre\", \"Pièce de la maison\", \"Partie du corps\", \r\n  \"Alimentation\", \"Boisson\", \"Marque de vêtements\", \"Émotion\", \"Super-héros\", \r\n  \"Pokémon\", \"Pays qui commence par…\", \"Film de Disney\", \"Animal marin\", \r\n  \"Animal de la savane\", \"Animal de compagnie\", \"Pays en Europe\", \"Pays en Afrique\", \r\n  \"Ville française\", \"Ville américaine\", \"Objet électronique\", \"Pays où il fait chaud\", \r\n  \"Pays avec une mer\", \"Profession médicale\", \"Marque de voiture\", \"Équipe de foot\", \r\n  \"Personnage de manga\", \"Jeu vidéo\", \"Appli mobile\", \"Nom de famille courant\", \r\n  \"Chiffre ou nombre\", \"Mot en anglais\", \"Mot en français\", \"Signe du zodiaque\", \r\n  \"Emoji connu\", \"Appareil électroménager\", \"Nom de star internationale\", \r\n  \"Nom de star française\", \"Personnage historique\", \"Nom de dinosaure\", \r\n  \"Élément chimique\", \"Forme géométrique\", \"Langue morte\", \r\n  \"Pays commençant par une voyelle\", \"Mot avec 3 lettres\", \"Mot avec 5 lettres\", \r\n  \"Animal volant\", \"Pays limitrophe de la France\", \"Ville avec une plage\", \r\n  \"Métier en rapport avec l'école\", \"Métier en rapport avec la police\", \r\n  \"Métier en rapport avec les animaux\", \"Métier qu'on voit à la télé\", \r\n  \"Chanson connue\", \"Groupe de musique\", \"Chiffre impair\", \"Couleur primaire\", \r\n  \"Style musical\", \"Accessoire de mode\", \"Pays ayant gagné la Coupe du Monde\", \r\n  \"Mot finissant par -ette\", \"Mot finissant par -oir\", \"Mot qui rime avec \\\"chat\\\"\", \r\n  \"Mot qui rime avec \\\"on\\\"\"\r\n];\r\n\r\nfunction generateCards() {\r\n  const cards = [];\r\n  \r\n  // 5 cartes lettres aléatoires\r\n  for (let i = 0; i < 5; i++) {\r\n    cards.push({\r\n      type: 'letter',\r\n      letter: LETTERS[Math.floor(Math.random() * LETTERS.length)],\r\n      id: `letter_${i}_${Date.now()}_${Math.random()}`\r\n    });\r\n  }\r\n  \r\n  // 1 joker\r\n  cards.push({\r\n    type: 'joker',\r\n    id: `joker_${Date.now()}_${Math.random()}`\r\n  });\r\n  \r\n  // 1 carte spéciale aléatoire\r\n  const specialCards = ['reverse', 'swap', 'stop'];\r\n  cards.push({\r\n    type: specialCards[Math.floor(Math.random() * specialCards.length)],\r\n    id: `special_${Date.now()}_${Math.random()}`\r\n  });\r\n  \r\n  // 1 carte Crakitoko avec 3 thèmes aléatoires\r\n  const shuffledThemes = [...THEMES_LIST].sort(() => 0.5 - Math.random());\r\n  cards.push({\r\n    type: 'crakitoko',\r\n    themes: shuffledThemes.slice(0, 3),\r\n    id: `crakitoko_${Date.now()}_${Math.random()}`\r\n  });\r\n  \r\n  return cards;\r\n}\r\n\r\nfunction generateDeck() {\r\n  const deck = [];\r\n  \r\n  // Générer plusieurs cartes de chaque type pour la pioche\r\n  for (let i = 0; i < 50; i++) {\r\n    deck.push({\r\n      type: 'letter',\r\n      letter: LETTERS[Math.floor(Math.random() * LETTERS.length)],\r\n      id: `deck_letter_${i}_${Date.now()}_${Math.random()}`\r\n    });\r\n  }\r\n  \r\n  for (let i = 0; i < 10; i++) {\r\n    deck.push({\r\n      type: 'joker',\r\n      id: `deck_joker_${i}_${Date.now()}_${Math.random()}`\r\n    });\r\n  }\r\n  \r\n  for (let i = 0; i < 15; i++) {\r\n    const specialCards = ['reverse', 'swap', 'stop'];\r\n    deck.push({\r\n      type: specialCards[Math.floor(Math.random() * specialCards.length)],\r\n      id: `deck_special_${i}_${Date.now()}_${Math.random()}`\r\n    });\r\n  }\r\n  \r\n  for (let i = 0; i < 20; i++) {\r\n    const shuffledThemes = [...THEMES_LIST].sort(() => 0.5 - Math.random());\r\n    deck.push({\r\n      type: 'crakitoko',\r\n      themes: shuffledThemes.slice(0, 3),\r\n      id: `deck_crakitoko_${i}_${Date.now()}_${Math.random()}`\r\n    });\r\n  }\r\n  \r\n  return deck.sort(() => 0.5 - Math.random());\r\n}\r\n\r\nfunction Lobby({ roomCode, playerName, playerId, roomData, onLeaveRoom }) {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  // Normaliser players pour qu'il soit toujours un Array valide\r\n  const normalizedPlayers = React.useMemo(() => {\r\n    if (!roomData?.players) return [];\r\n    \r\n    if (Array.isArray(roomData.players)) {\r\n      return roomData.players.filter(p => p && p.id && p.name);\r\n    }\r\n    \r\n    if (typeof roomData.players === 'object') {\r\n      const playersArray = Object.values(roomData.players)\r\n        .filter(p => p && typeof p === 'object' && p.id && p.name);\r\n      return playersArray;\r\n    }\r\n    \r\n    return [];\r\n  }, [roomData?.players]);\r\n\r\n  const isHost = normalizedPlayers.find(p => p.id === playerId)?.isHost || false;\r\n  const canStart = normalizedPlayers.length >= 2;\r\n\r\n  // Mise à jour de présence SANS créer de boucle infinie\r\n  useEffect(() => {\r\n    if (roomData?.gameStarted) {\r\n      return;\r\n    }\r\n\r\n    const updatePresence = async () => {\r\n      try {\r\n        // NE PAS utiliser normalizedPlayers ici car il cause des problèmes\r\n        // Utiliser directement roomData.players\r\n        if (!roomData?.players) return;\r\n        \r\n        let playerIndex = -1;\r\n        \r\n        if (Array.isArray(roomData.players)) {\r\n          playerIndex = roomData.players.findIndex(p => p && p.id === playerId);\r\n        } else if (typeof roomData.players === 'object') {\r\n          const playersArray = Object.values(roomData.players);\r\n          playerIndex = playersArray.findIndex(p => p && p.id === playerId);\r\n        }\r\n        \r\n        if (playerIndex !== -1) {\r\n          await updateDoc(doc(db, 'rooms', roomCode), {\r\n            [`players.${playerIndex}.lastSeen`]: Date.now(),\r\n            [`players.${playerIndex}.connected`]: true\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error('Erreur mise à jour présence:', err);\r\n      }\r\n    };\r\n\r\n    // Mise à jour initiale\r\n    updatePresence();\r\n    \r\n    // Mise à jour périodique\r\n    const interval = setInterval(updatePresence, 30000); // Toutes les 30 secondes\r\n\r\n    return () => clearInterval(interval);\r\n  }, [roomCode, playerId, roomData?.gameStarted]); // Dépendances minimales\r\n\r\n  const startGame = async () => {\r\n    if (!canStart) {\r\n      setError('Il faut au moins 2 joueurs pour commencer');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError('');\r\n\r\n    try {\r\n      // Choisir un joueur aléatoire pour choisir le thème initial\r\n      const randomPlayerIndex = Math.floor(Math.random() * normalizedPlayers.length);\r\n      \r\n      // Préparer les joueurs pour le jeu\r\n      const gamePlayers = normalizedPlayers.map(player => ({\r\n        ...player,\r\n        cards: player.cards || generateCards()\r\n      }));\r\n      \r\n      // Créer une carte Crakitoko avec 3 thèmes pour la sélection initiale\r\n      const shuffledThemes = [...THEMES_LIST].sort(() => 0.5 - Math.random());\r\n      const initialThemeChoices = shuffledThemes.slice(0, 3);\r\n      \r\n      // Générer le deck\r\n      const deck = generateDeck();\r\n      \r\n      await updateDoc(doc(db, 'rooms', roomCode), {\r\n        gameStarted: true,\r\n        currentPlayerIndex: randomPlayerIndex,\r\n        themeSelectionPhase: true,\r\n        gamePhase: 'theme-selection',\r\n        currentRound: 1,\r\n        gameStartTime: Date.now(),\r\n        themeChoices: initialThemeChoices,\r\n        players: gamePlayers,\r\n        direction: 1,\r\n        deck: deck,\r\n        lastPlayedCard: null,\r\n        votes: {},\r\n        currentTheme: null\r\n      });\r\n      \r\n    } catch (err) {\r\n      setError('Erreur lors du démarrage de la partie');\r\n      console.error('Erreur startGame:', err);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const leaveRoom = async () => {\r\n    try {\r\n      if (roomData && normalizedPlayers.length > 0) {\r\n        const updatedPlayers = normalizedPlayers.filter(p => p.id !== playerId);\r\n        \r\n        if (updatedPlayers.length > 0) {\r\n          // Si l'hôte part, donner les droits d'hôte au premier joueur restant\r\n          if (isHost) {\r\n            updatedPlayers[0].isHost = true;\r\n          }\r\n          \r\n          await updateDoc(doc(db, 'rooms', roomCode), {\r\n            players: updatedPlayers\r\n          });\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Erreur lors de la sortie de la room:', err);\r\n    }\r\n    \r\n    onLeaveRoom();\r\n  };\r\n\r\n  if (!roomData) {\r\n    return <div className=\"loading\">Chargement...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"lobby\">\r\n      <div className=\"lobby-container\">\r\n        <div className=\"lobby-header\">\r\n          <h1>🎮 Salle: {roomCode}</h1>\r\n          <button onClick={leaveRoom} className=\"btn btn-danger leave-btn\">\r\n            Quitter\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"players-section\">\r\n          <h2>👥 Joueurs ({normalizedPlayers.length}/10)</h2>\r\n          <div className=\"players-list\">\r\n            {normalizedPlayers.length > 0 ? normalizedPlayers.map((player) => (\r\n              <div key={player.id} className={`player-card ${!player.connected ? 'disconnected' : ''}`}>\r\n                <span className=\"player-name\">\r\n                  {player.name}\r\n                  {player.isHost && <span className=\"host-badge\">👑</span>}\r\n                  {!player.connected && <span className=\"disconnect-badge\">📴</span>}\r\n                </span>\r\n              </div>\r\n            )) : (\r\n              <div>Chargement des joueurs...</div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {isHost && (\r\n          <div className=\"host-controls\">\r\n            <h3>🎯 Contrôles d'hôte</h3>\r\n            \r\n            {!canStart && (\r\n              <p className=\"warning\">Il faut au moins 2 joueurs pour commencer la partie.</p>\r\n            )}\r\n            \r\n            <button \r\n              onClick={startGame}\r\n              disabled={!canStart || loading}\r\n              className=\"btn btn-primary start-btn\"\r\n            >\r\n              {loading ? 'Démarrage...' : 'Commencer la partie'}\r\n            </button>\r\n            \r\n            {error && <div className=\"error-message\">{error}</div>}\r\n          </div>\r\n        )}\r\n\r\n        {!isHost && (\r\n          <div className=\"waiting-message\">\r\n            <p>⏳ En attente que l'hôte lance la partie...</p>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"lobby-info\">\r\n          <h3>📋 Règles du jeu</h3>\r\n          <ul>\r\n            <li>🎯 Quand vous posez une carte, les autres votent</li>\r\n            <li>🗳️ Ils votent si vous pouvez dire un mot selon le thème</li>\r\n            <li>❌ Vote négatif = vous récupérez votre carte + 1 de la pioche</li>\r\n            <li>✅ Vote positif = le joueur suivant prend le malus de la lettre</li>\r\n            <li>🃏 Joker = aucun malus peu importe ce que vous dites</li>\r\n            <li>⏱️ 15 secondes pour jouer, 10 secondes pour voter</li>\r\n            <li>🏆 Premier sans cartes gagne !</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Lobby;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}